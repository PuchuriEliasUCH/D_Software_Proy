<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Dashboard Admin — DASSO by StoqING</title>

    <!-- Fuentes iguales que en landing -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/admin-dashboard.css}">
</head>
<body>
<!-- Header con el mismo estilo que el index -->
<header th:insert="~{/fragments/navbar :: navbar}"></header>

<main class="container-main">
    <div class="card">
        <h4>Panel Administrativo</h4>
        <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
            <label class="small-muted" for="adminDate" style="min-width:110px">Selecciona fecha:</label>
            <input id="adminDate" type="date" class="form-control" style="max-width:200px"/>
            <button class="btn btn-dark" style="margin-left:8px" type="button" onclick="renderAdmin()">Ver</button>

            <div style="margin-left:auto; display:flex; gap:8px;">
                <button id="mesasBtn" class="btn btn-primary" type="button">Ir a Mesas</button>
                <form th:action="@{/logout}" method="post">
                    <button id="logoutBtn" class="btn btn-outline-danger" type="submit">Cerrar sesión</button>
                </form>
            </div>
        </div>

        <!-- KPIs del documento -->
        <div style="margin-top:18px" class="kpis">
            <div class="kpi">
                <div class="small-muted">Reservas canceladas</div>
                <div class="value" id="kpiCanceladas">0</div>
            </div>
            <div class="kpi">
                <div class="small-muted">Reservas programadas</div>
                <div class="value" id="kpiProgramadas">0</div>
            </div>
            <div class="kpi">
                <div class="small-muted">Reservas en curso</div>
                <div class="value" id="kpiEnCurso">0</div>
            </div>
            <div class="kpi">
                <div class="small-muted">Reservas finalizadas</div>
                <div class="value" id="kpiFinalizadas">0</div>
            </div>
        </div>

        <!-- KPI operativo extra -->
        <div class="kpis" style="margin-top:12px">
            <div class="kpi" style="background:#fff9e6;border:1px solid #ffe08a">
                <div class="small-muted">Mesas por asignar / reasignar</div>
                <div class="value" id="kpiMesasPorAsignar">0</div>
            </div>
        </div>

        <!-- Operativa: pendientes de pago -->
        <div style="margin-top:18px">
            <h5>Solicitudes de reserva (pendientes de pago)</h5>
            <div class="small-muted">Se cancelan automáticamente si no se paga en 15 min. (countdown en vivo)</div>
            <div id="pendientesAccept" style="margin-top:12px" aria-live="polite"></div>
        </div>

        <!-- Operativa: mesas por asignar / reasignar -->
        <div style="margin-top:18px">
            <h5>Mesas por asignar / reasignar (por mantenimiento o mesa no definida)</h5>
            <div id="porAsignarList" style="margin-top:12px" aria-live="polite"></div>
        </div>
    </div>
</main>

<!-- Modal Asignación -->
<div id="assignModal" class="modal-overlay" style="display:none;">
    <div class="modal-card">
        <h5>Asignar mesa</h5>
        <div class="mb-2">
            <label class="form-label" for="assignUbic">Ubicación</label>
            <select id="assignUbic" class="form-control">
                <option value="salon">Salón</option>
                <option value="segundo_piso">Segundo piso</option>
            </select>
        </div>
        <div class="mb-2">
            <label class="form-label" for="assignMesa">Mesa</label>
            <select id="assignMesa" class="form-control"></select>
        </div>
        <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px">
            <button id="assignCancel" class="btn btn-outline-secondary" type="button" onclick="document.getElementById('assignModal').style.display='none'">Cancelar</button>
            <button id="assignSave" class="btn btn-dark" type="button">Guardar</button>
        </div>
    </div>
</div>

<script defer th:src="@{/js/dashboard.js}"></script>
</body>
</html>
